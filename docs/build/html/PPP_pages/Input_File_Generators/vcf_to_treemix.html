

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>vcf_to_treemix.py: VCF to treemix Conversion Function &mdash; PPP 0.1.7 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="vcf_to_gphocs.py: VCF to GPhocs Conversion Function" href="vcf_to_gphocs.html" />
    <link rel="prev" title="vcf_to_ima.py: VCF to IMa Conversion Function" href="vcf_to_ima.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> PPP
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">PPP Core Functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../input_file_generators.html">PPP Input File Generators</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vcf_format_conversions.html">vcf_format_conversions.py: VCF to Plink/EIGENSTRAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="vcf_to_ima.html">vcf_to_ima.py: VCF to IMa Conversion Function</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">vcf_to_treemix.py: VCF to treemix Conversion Function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#required-arguments">Required Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-aguments">Optional Aguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">Example usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vcf_to_gphocs.html">vcf_to_gphocs.py: VCF to GPhocs Conversion Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="vcf_to_fastsimcoal.html">vcf_to_fastsimcoal.py: VCF to fastsimcoal Conversion Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="vcf_to_dadi.html">vcf_to_dadi.py: VCF to dadi Conversion Function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analyses.html">PPP Analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">PPP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model.html">Model File and Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citations.html">Citations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PPP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../input_file_generators.html">PPP Input File Generators</a> &raquo;</li>
        
      <li>vcf_to_treemix.py: VCF to treemix Conversion Function</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/PPP_pages/Input_File_Generators/vcf_to_treemix.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-vcf_to_treemix">
<span id="vcf-to-treemix-py-vcf-to-treemix-conversion-function"></span><h1>vcf_to_treemix.py: VCF to treemix Conversion Function<a class="headerlink" href="#module-vcf_to_treemix" title="Permalink to this headline">¶</a></h1>
<p>The treemix program was developed by Pickrell and Prichard (2012)
to estimate phylogeny and admixture for closely related populations.</p>
<p>Pickrell JK, Pritchard JK (2012) Inference of Population Splits and Mixtures
from Genome-Wide Allele Frequency Data. PLOS Genetics 8(11): e1002967.</p>
<p>The program can make use of very large numbers of SNPs.</p>
<p>vcf_to_treemix.py will generate a treemix input file from a vcf file.</p>
<p>If run using the --bed-file and --kblock options, the resulting treemix
file can be run using the 'linkage disequilibrium' (-k) option.
Under this option each block of kblock SNPs are treated as a linked group
and different groups are treated as unlinked.</p>
<div class="section" id="required-arguments">
<h2>Required Arguments<a class="headerlink" href="#required-arguments" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt><strong>--vcf</strong> <em>&lt;input_vcf_filename&gt;</em></dt><dd><p>The name of the vcf file.  This can be a bgzipped vcf file. .</p>
</dd>
<dt><strong>--model-file</strong> <em>&lt;model_file_name&gt;</em></dt><dd><p>The name of a PPP model file.</p>
</dd>
<dt><strong>--modelname</strong> <em>&lt;model_name&gt;</em></dt><dd><p>The name of a model in the model file.  The treemix file to be
generated will contain the allele counts for each SNP in each of
the populations.  The treemix run will estimate the phylogeny
for the populations in the model.</p>
</dd>
<dt><strong>--out</strong> <em>&lt;outpuf_file_name&gt;</em></dt><dd><p>The name of the treemix file to be generated. The file is bgzipped
and '.gz' is added to the end of the name</p>
</dd>
</dl>
</div>
<div class="section" id="optional-aguments">
<h2>Optional Aguments<a class="headerlink" href="#optional-aguments" title="Permalink to this headline">¶</a></h2>
<dl>
<dt><strong>--bed-file</strong> <em>&lt;BED_file_name&gt;</em></dt><dd><p>The BED file is a sorted UCSC-style bedfile containing chromosome locations of
the SNPs to be included in the output file. The BED file has no header.
The first column is the chromosome name (this must match the chromosome
name in the vcf file).
The second column is start position (0-based, open interval)
The third column is end position (closed interval).
Any other columns are ignored.</p>
<p>If used with --kblock,  each of the BED file regions is used to generate
one block of SNPs</p>
</dd>
<dt><strong>--kblock</strong> <em>&lt;k_block_size&gt;</em></dt><dd><p>Used with --bed-file, for using treemix runtime option -k.  
k is the number of SNPs in a block in the treemix file. 
If the actual number of SNPs in a BED file interval is less than kblock,
then additional invariant rows are added to the treemix file so
the total numbers of rows for that and every block is equal to kblock.
k is set to 1000 by default.  It needs to be increased only when
one or more BED file regions have more than k snps.</p>
</dd>
</dl>
</div>
<div class="section" id="example-usage">
<h2>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>Example command-lines:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vcf_to_treemix.py -h
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>   vcf_to_treemix.py --vcf pan_example.vcf.gz --model-file panmodels.model --modelname 4Pop --out vcf_treemixtest1 --bed-file pan_example_regions.bed --kblock <span class="m">1000</span>

.. code-block:: bash

   vcf_to_treemix.py --vcf pan_example.vcf.gz --model-file panmodels.model --modelname 4Pop --out vcf_treemixtest2    
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vcf_to_gphocs.html" class="btn btn-neutral float-right" title="vcf_to_gphocs.py: VCF to GPhocs Conversion Function" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vcf_to_ima.html" class="btn btn-neutral float-left" title="vcf_to_ima.py: VCF to IMa Conversion Function" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, PPP Development Team. This material is based upon work supported by the National Science Foundation under Grant Number (NSF ABI 1564659 to Arun Sethuraman and Jody Hey)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>