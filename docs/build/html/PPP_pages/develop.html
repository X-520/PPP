

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Development &mdash; PPP 0.1.11 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contact Us" href="contact.html" />
    <link rel="prev" title="model_creator.py: Model File Creator" href="Functions/model_creator.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PPP
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Usage and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">PPP Core Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_file_generators.html">PPP Input File Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyses.html">PPP Analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">PPP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model File and Creation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#development-guidelines">Development Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-ppp-classes">Using PPP Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vcf-class">VCF Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modelfile-class">ModelFile Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-class">Model Class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact Us</a></li>
<li class="toctree-l1"><a class="reference internal" href="citations.html">Citations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PPP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/PPP_pages/develop.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h1>
<p>As it would be unlikely that the PPP would encompass all desired procedures/methods, we has included this section to aid in the development of additional functionality for the PPP.</p>
<div class="section" id="development-guidelines">
<h2>Development Guidelines<a class="headerlink" href="#development-guidelines" title="Permalink to this headline">¶</a></h2>
<p><strong>In general:</strong></p>
<ul class="simple">
<li><p>Functions developed for the PPP should be modular – i.e. function independently – primarily to maintain a flexible platform, this is especially important when considering <a class="reference external" href="https://galaxyproject.org/">Galaxy</a> integration.</p></li>
<li><p>Functions should be able to be imported from <strong>pgpipe</strong>, so that multiple functions may be used within a single python script or <a class="reference external" href="https://jupyter.org/">Jupyter notebook</a>.</p></li>
<li><p>Functions should support the use of Model files for automatic assignment of relevant meta-data. <em>Note: details on the model file class may be found below</em></p></li>
<li><p>Functions that use third-party software should include the relevant reference(s) within log files.</p></li>
</ul>
</div>
<div class="section" id="using-ppp-classes">
<h2>Using PPP Classes<a class="headerlink" href="#using-ppp-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="vcf-class">
<h3>VCF Class<a class="headerlink" href="#vcf-class" title="Permalink to this headline">¶</a></h3>
<p><em>italic</em>
<strong>BOLD</strong>
outside link: <a class="reference external" href="https://google.com//">Google</a>.
internal link: <span class="xref std std-ref">examples</span></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>my_code.py
</pre></div>
</div>
<p>The <strong>VcfReader()</strong> class is responsible for integrating VCF files into the PPP. It can parse unzipped and bgzipped VCFs (as well as BCFs), allowing for the SNP records of those files to be accessed in multiple ways, such as sequentially or from a particular region (as implemented in the <strong>GeneRegion</strong> class). It can also subsample requested individuals from a VCF using the <strong>ModelFile</strong> functionality or by providing a list of individuals to sample. The class can be initialized as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgpipe</span> <span class="kn">import</span> <span class="n">VcfReader</span>

<span class="n">vcf_reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VcfReader</span><span class="p">(</span><span class="n">vcf_filename</span><span class="p">)</span>
</pre></div>
</div>
<p>There are two primary operating modes for this class: operating on bgzipped or unzipped data. For unzipped data, there is a requirement that records are fetched from the file sequentially, so selecting records using gene regions requires those regions be sorted (as they are by default). For a bgzipped file, a tabix index must be created in order to access any records.</p>
<p>To perform an action on different regions specified in a BED file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">region_list</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RegionList</span><span class="p">(</span><span class="n">bed_filename</span><span class="p">)</span>
<span class="n">vcf_reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VcfReader</span><span class="p">(</span><span class="n">vcf_filename</span><span class="p">)</span>

<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">region_list</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">vcf_reader</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
  <span class="c1">##Add logic here</span>
</pre></div>
</div>
<p>To subsample the VCF for given individuals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_file</span> <span class="o">=</span> <span class="n">pgpipe</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">read_model_file</span><span class="p">(</span><span class="n">model_filename</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_filename</span><span class="p">[</span><span class="n">model_tag</span><span class="p">]</span>

<span class="n">vcf_reader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">VcfReader</span><span class="p">(</span><span class="n">vcf_filename</span><span class="p">,</span> <span class="n">popmodel</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="modelfile-class">
<h3>ModelFile Class<a class="headerlink" href="#modelfile-class" title="Permalink to this headline">¶</a></h3>
<p>Model files may be read using the function <strong>read_model_file()</strong> found within the model.py module. The reader accepts the filename (as a string) of the model file and returns a <strong>ModelFile</strong> class object as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># Read in the model file
model_file = pgpipe.model.read_model_file(“path/to/my_model_file.model”)
</pre></div>
</div>
<p>A <strong>ModelFile</strong> class object primarily behaves as a dictionary of <strong>Model</strong> class objects; the keys of the dictionary are the model names (as strings) of the <strong>Model</strong> class objects whereas the values are the objects themselves. Therefore, a <strong>Model</strong> named <em>2Pop</em> may assigned as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># Assign the 2Pop model, from model file
model_2pop =  model_file[‘2Pop’]
</pre></div>
</div>
<p>A <strong>ModelFile</strong> class object also has two additional attributes:</p>
<ul class="simple">
<li><p>ind_file: If created, the filename of a file containing all the unique individuals found within all models stored within the <strong>ModelFile</strong>.</p></li>
<li><p>exclude_file: If created, the filename of a file containing all the unique individuals found within all models stored within the <strong>ModelFile</strong> that do not match a given list of individuals.</p></li>
</ul>
<p>These attributes may be populated and their files created using the following functions: <strong>create_ind_file()</strong> and <strong>create_exclude_ind_file()</strong>. The inverse operating can also be completed using <strong>delete_ind_file()</strong> and <strong>delete_exclude_ind_file()</strong>.</p>
</div>
<div class="section" id="model-class">
<h3>Model Class<a class="headerlink" href="#model-class" title="Permalink to this headline">¶</a></h3>
<p>The <strong>Model</strong> class is used to store model meta-data. The primary attributes of the class are:</p>
<ul class="simple">
<li><p>name: The name (as a string) of the model</p></li>
<li><p>tree: The newick tree of the model</p></li>
<li><p>pop_list: A list of the population names within the model</p></li>
<li><p>ind_dict: A dictionary used to store the individuals within each population; the keys of the  dictionary are the population names whereas the values are lists of individuals.</p></li>
<li><p>nind: A dictionary used to store the number of individuals within each population; the keys of the  dictionary are the population names whereas the values are individual counts.</p></li>
<li><p>npop: The number of populations within the model</p></li>
<li><p>inds: A list of all individuals in the model</p></li>
</ul>
<p>A Model may be created with all primary attributes populated as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">pgpipe</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;2Pop&quot;</span><span class="p">)</span>

<span class="c1"># Assign the model tree</span>
<span class="n">model</span><span class="o">.</span><span class="n">assign_tree</span><span class="p">(</span><span class="s2">&quot;(A,B);&quot;</span><span class="p">)</span>

<span class="c1"># Assign the populations and their individuals</span>
<span class="n">model</span><span class="o">.</span><span class="n">assign_pop</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Ind1&quot;</span><span class="p">,</span> <span class="s2">&quot;Ind2&quot;</span><span class="p">,</span> <span class="s2">&quot;Ind3&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">assign_pop</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Ind4&quot;</span><span class="p">,</span> <span class="s2">&quot;Ind5&quot;</span><span class="p">,</span> <span class="s2">&quot;Ind6&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>A <strong>Model</strong> class object also has two additional attributes:</p>
<ul class="simple">
<li><p>pop_files: If created, a list of population filenames. Each population file consist of the individuals found within the population.</p></li>
<li><p>ind_file: If created, the filename of a file containing all the unique individuals found within the model.</p></li>
</ul>
<p>These attributes may be populated and their files created using the following functions: <strong>create_ind_file()</strong> and <strong>create_pop_files()</strong>. The inverse operating can also be completed using <strong>delete_ind_file()</strong> and <strong>delete_pop_files()</strong>.</p>
<p>Lastly, a <strong>Model</strong> class object masy be assigned to a <strong>ModelFile</strong> class object as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create ModelFile object</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">pgpipe</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ModelFile</span><span class="p">()</span>

<span class="c1"># Save the model</span>
<span class="n">models</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contact.html" class="btn btn-neutral float-right" title="Contact Us" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Functions/model_creator.html" class="btn btn-neutral float-left" title="model_creator.py: Model File Creator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, PPP Development Team. This material is based upon work supported by the National Science Foundation under Grant Number (NSF ABI 1564659 to Arun Sethuraman and Jody Hey)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>